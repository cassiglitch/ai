<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Isogle</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    function init() {
      gapi.client.init({
        'apiKey': 'AIzaSyAwydGicPoEr05z1a1b6W06V2Wzl-_NVxo',
        'discoveryDocs': ['https://www.googleapis.com/discovery/v1/apis/customsearch/v1/rest', 'https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest'],
        'scope': 'https://www.googleapis.com/auth/youtube.force-ssl https://www.googleapis.com/auth/userinfo.email',
      }).then(function() {
        console.log('API client initialized');
      }, function(error) {
        console.log('Error initializing API client:', error);
      });
    }

    function searchAll() {
      var query = document.getElementById('query').value.trim();
      searchGoogle(query);
      searchVideos(query);
    }

    function searchGoogle(query) {
      gapi.client.customsearch.cse.list({
        q: query,
        cx: '718cd7b701a714611',
        num: 10
      }).then(function(response) {
        var searchResultsHTML = '';
        var items = response.result.items;
        if (items) {
          items.forEach(function(item) {
            searchResultsHTML += '<div>';
            if (item.pagemap && item.pagemap.cse_image && item.pagemap.cse_image.length > 0) {
              searchResultsHTML += '<img src="' + item.pagemap.cse_image[0].src + '">';
            }
            searchResultsHTML += '<h4><a href="' + item.link + '">' + item.title + '</a></h4>';
            searchResultsHTML += '<p>' + item.snippet + '</p>';
            searchResultsHTML += '</div>';
          });
        } else {
          searchResultsHTML = '<p>No results found</p>';
        }
        searchResults.innerHTML = searchResultsHTML;
      });
    }

    function searchVideos(query) {
      gapi.client.youtube.search.list({
        q: query,
        part: 'snippet',
        maxResults: 10
      }).then(function(response) {
        var searchResultsHTML = '';
        var items = response.result.items;
        if (items) {
          items.forEach(function(item) {
            searchResultsHTML += '<div>';
            searchResultsHTML += '<a href="https://www.youtube.com/watch?v=' + item.id.videoId + '"><img src="' + item.snippet.thumbnails.default.url + '"></a>';
            searchResultsHTML += '<h4><a href="https://www.youtube.com/watch?v=' + item.id.videoId + '">' + item.snippet.title + '</a></h4>';
            searchResultsHTML += '<p>' + item.snippet.description + '</p>';
            searchResultsHTML += '<p>Duration: ' + formatDuration(item.contentDetails.duration) + '</p>';
            searchResultsHTML += '</div>';
          });
        } else {
          searchResultsHTML = '<p>No results found</p>';
        }
        searchResults.innerHTML += searchResultsHTML;
      });
    }

    function formatDuration(duration) {
      var match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
      var hours = (parseInt(match[1]) || 0);
      var minutes = (parseInt(match[2]) || 0);
      var seconds = (parseInt(match[3]) || 0);
      var durationString = '';
      if (hours > 0) {
        durationString += hours + ':';
      }
      if (minutes < 10) {
        durationString += '0';
      }
      durationString += minutes + ':';
      if (seconds < 10) {
        durationString += '0';
      }
      durationString += seconds;
      return durationString;
    }

    function onYouTubeIframeAPIReady() {
      var player = new YT.Player('player', {
        height: '360',
        width: '640',
        videoId: 'M7lc1UVf-VE',
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerReady(event) {
      event.target.playVideo();
    }

    function onPlayerStateChange(event) {
      if (event.data == YT.PlayerState.PLAYING && !done) {
        setTimeout(stopVideo, 6000);
        done = true;
      }
    }

    function stopVideo() {
      player.stopVideo();
    }
  </script>
</head>
<body>
  <div>
    <input type="text" id="query" placeholder="Enter search query">
   <button onclick="searchAll()">Search</button>
  </div>
<p>Search Results:</p>
<div id="searchResults"></div>
</body>
</html>
